(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DemoNavmap"],{c402:function(e,t,o){"use strict";o.r(t);var r=o("f2bf"),a={id:"DemoNavmap"},l={style:{float:"left",width:"800px"}},i=Object(r["h"])("div",{style:{"margin-left":"auto","margin-right":"15px"}},"实时的缩略导航图",-1),n={style:{float:"left",width:"280px",border:"1px solid #999"}},s=Object(r["h"])("div",{id:"demo_navmap",style:{height:"180px"}},null,-1);function h(e,t,o,h,p,d){var c=Object(r["A"])("goo-flow");return Object(r["t"])(),Object(r["g"])("div",a,[Object(r["h"])("div",l,[Object(r["k"])(c,{property:p.myProps,global:p.global,plugIns:p.plugIns,navSelector:"#demo_navmap",ref:"gooFlow"},{headerCustom:Object(r["H"])((function(){return[i]})),_:1},8,["property","global","plugIns"])]),Object(r["h"])("div",n,[(Object(r["t"])(),Object(r["e"])(r["b"],null,[s],1024))])])}var p=o("1fde"),d=(o("ac1f"),o("5319"),o("cb29"),o("1276"),o("14d9"),o("9fb2")),c=o("e7cb"),u=o("d4d2"),f={canvasExtend:function(){Object(d["a"])()},_toNum:function(e){return null!==e&&""!==e?parseInt(e.split("px")[0],10):void 0},_analyseArea:function(e){var t=e.querySelector(".bg"),o=c["a"].getRealStyle(t);return{top:this._toNum(e.style.top),left:this._toNum(e.style.left),width:e.offsetWidth,height:e.offsetHeight,borderColor:o.borderTopColor,bgColor:o.backgroundColor,opacity:parseFloat(o.opacity)}},renderAreas:function(e,t,o){for(var r in t){var a=t[r];e.save(),a.bgColor=a.bgColor.replace("rgb","rgba").replace(")",", "+a.opacity+")"),a.borderColor=a.borderColor.replace("rgb","rgba").replace(")",", "+a.opacity+")"),e.fillStyle=a.bgColor,e.strokeStyle=a.borderColor,e.beginPath(),e.rect(a.left*o,a.top*o,a.width*o,a.height*o),e.fill(),e.stroke(),e.closePath(),e.restore()}},_analyseMemo:function(e,t){var o=c["a"].getRealStyle(e);return{top:this._toNum(e.style.top)*t,left:this._toNum(e.style.left)*t,width:e.offsetWidth*t,height:e.offsetHeight*t,bgColor:o.color}},renderMemos:function(e,t){for(var o in t){var r=t[o];e.save(),e.fillStyle=r.bgColor,e.beginPath(),e.moveTo(r.left+5,r.top),e.lineTo(r.left+r.width,r.top),e.lineTo(r.left+r.width,r.top+r.height),e.lineTo(r.left,r.top+r.height),e.lineTo(r.left,r.top+5),e.lineTo(r.left+5,r.top),e.closePath(),e.fill(),e.restore(),e.save(),e.fillStyle="rgba(0,0,0,0.1)",e.beginPath(),e.moveTo(r.left+5,r.top),e.lineTo(r.left+5,r.top+5),e.lineTo(r.left,r.top+5),e.lineTo(r.left+5,r.top),e.closePath(),e.fill(),e.restore()}},_analyseNode:function(e,t){var o="";u["a"].hasClass(e,"item_ellipse")&&(o="ellipse"),u["a"].hasClass(e,"item_rhomb")&&(o="rhomb"),u["a"].hasClass(e,"item_round")&&(o="round"),u["a"].hasClass(e,"item_parallelogram")&&(o="parallelogram"),u["a"].hasClass(e,"item_custom")&&(o="custom");var r=c["a"].getRealStyle(e),a={top:this._toNum(e.style.top)*t,left:this._toNum(e.style.left)*t,width:e.offsetWidth*t,height:e.offsetHeight*t,borderColor:r.borderTopColor,borderWidth:this._toNum(r.borderTopWidth)*t,bgColor:r.backgroundColor,borderRadius:this._toNum(r.borderTopLeftRadius),spClass:o};return"custom"===o&&(a.borderColor="#999999"),a},renderNodes:function(e,t){for(var o in e.save(),t){var r=t[o];e.fillStyle=r.bgColor,"ellipse"===r.spClass?e.BezierEllipse(r.left+r.width/2,r.top+r.height/2,r.width/2,r.height/2).fill():"rhomb"===r.spClass?(e.save(),e.translate(r.left+r.width/2,r.top+r.height/2),e.rotate(45*Math.PI/180),e.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),e.restore()):"parallelogram"===r.spClass?(e.save(),e.translate(r.left+r.width/2,r.top+r.height/2),e.transform(1,0,-12/r.height,1,0,0),e.roundRect(-r.width/2,-r.height/2,r.width-r.borderWidth,r.height-r.borderWidth,r.borderRadius).fill(),e.restore()):"custom"===r.spClass?(e.save(),e.strokeStyle=r.borderColor,e.lineCap="round",e.roundRect(r.left,r.top,r.width,r.height,r.borderRadius).stroke(),e.beginPath(),e.moveTo(r.left+2,r.top+2),e.lineTo(r.left+r.width-2,r.top+r.height-2),e.moveTo(r.left+2,r.top+r.height-2),e.lineTo(r.left+r.width-2,r.top+2),e.closePath(),e.stroke(),e.restore()):e.roundRect(r.left,r.top,r.width,r.height,r.borderRadius).fill(),"custom"!==r.spClass&&(e.strokeStyle=r.borderColor,e.lineWidth=0!==r.borderWidth?r.borderWidth:.1,e.stroke())}e.restore()},_analyseLine:function(e,t){var o=e.querySelector("path[stroke-linecap]"),r=o.getAttribute("marker-end"),a={color:o.getAttribute("stroke"),lineWidth:o.getAttribute("stroke-width")*t,lineCap:"round",noArrow:!r||null==r},l=o.style.strokeDasharray;a.lineDash=l&&null!=l;for(var i=o.getAttribute("d"),n=i.substring(2,i.length).split(/[L|Q]/),s=[],h=0;h<n.length;++h){n[h]=n[h].replace(/^\s+|\s+$/gm,"");var p=n[h].split(" ");2===p.length?s.push({x:parseFloat(p[0])*t,y:parseFloat(p[1])*t}):s.push({x:parseFloat(p[0])*t,y:parseFloat(p[1])*t,dX:parseFloat(p[2])*t,dY:parseFloat(p[3])*t})}a.points=s;var d=s.length,c=s[d-1].x-s[d-2].x,u=s[d-1].y-s[d-2].y;return a.angle=Math.atan2(u,c),a},renderLines:function(e,t){for(var o in t){var r=t[o];e.save(),e.setLineDash(r.lineDash?[2,3]:[]),e.strokeStyle=r.color,e.lineWidth=r.lineWidth,e.lineCap=r.lineCap;var a=r.points;e.beginPath(),e.moveTo(a[0].x,a[0].y);for(var l=1;l<a.length;++l)if(a[l].dX){var i=a[l].y===a[l].dY?Math.abs(a[l].x-a[l].dX):Math.abs(a[l].y-a[l].dY);e.arcTo(a[l].x,a[l].y,a[l].dX,a[l].dY,i),e.moveTo(a[l].dX,a[l].dY)}else e.lineTo(a[l].x,a[l].y),l!==a.length-1&&e.moveTo(a[l].x,a[l].y);e.closePath(),e.stroke(),r.noArrow||(e.translate(a[a.length-1].x,a[a.length-1].y),e.rotate(r.angle),e.fillStyle=r.color,e.beginPath(),e.moveTo(1*r.lineWidth,0),e.lineTo(-6*r.lineWidth,-3*r.lineWidth),e.lineTo(-6*r.lineWidth,3*r.lineWidth),e.lineTo(1*r.lineWidth,0),e.closePath(),e.fill()),e.restore()}},_clearMap:function(e){e.getContext("2d").clearRect(0,0,parseInt(e.getAttribute("width")),parseInt(e.getAttribute("height")));var t=e.nextSibling;t&&null!=t&&"viewbox"===t.className&&(t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%")}},g={flag:"navmap",initFuncName:"canvasExtend",methods:{canvasExtend:function(){f.canvasExtend()},_locateViewBox:function(e){var t=this.prop.$navMap.querySelector(".viewbox"),o=this.$refs.$workArea.parentNode,r=o.scrollLeft*e,a=o.scrollTop*e;t.style.left=r+"px",t.style.top=a+"px",t.style.width=o.clientWidth*e+"px",t.style.height=o.clientHeight*e+"px"},refreshMap:function(){var e=this.prop.$navMap.querySelector("canvas"),t=e.getContext("2d");f._clearMap(e);var o=this._buildWorkSize();if(o.haveData){var r=e.width/o.width>e.height/o.height?e.height/o.height:e.width/o.width;this.prop.$navMap.setAttribute("scale",""+r);for(var a={},l=this.$refs.$group.querySelectorAll(".GooFlow_area"),i=0;i<l.length;++i)a[l[i].id]=f._analyseArea(l[i]);f.renderAreas(t,a,r);for(var n={},s=this.$refs.$paper.querySelectorAll(".GooFlow_memo"),h=0;h<s.length;++h)n[s[h].id]=f._analyseMemo(s[h],r);f.renderMemos(t,n);for(var p={},d=this.$refs.$workArea.querySelectorAll(".GooFlow_item"),c=0;c<d.length;++c)p[d[c].id]=f._analyseNode(d[c],r);f.renderNodes(t,p);for(var u={},g=this.$refs.$draw.querySelectorAll("g"),v=0;v<g.length;++v)"GooFlow_tmp_line"!==g[v].getAttribute("tid")&&(u[g[v].id]=f._analyseLine(g[v],r));f.renderLines(t,u),this._locateViewBox(r)}},_initNavMap:function(e){if(e&&null!=e&&""!==e)if(this.prop.$navMap=document.querySelector(e),this.prop.$navMap&&null!=this.prop.$navMap){var t=this.prop.$navMap.clientWidth,o=this.prop.$navMap.clientHeight;this.prop.$navMap.className="GooFlow_nav_map",this.prop.$navMap.style.width=t+"px",this.prop.$navMap.style.height=o+"px",this.prop.$navMap.setAttribute("unselectable","on"),this.prop.$navMap.setAttribute("onselectstart","return false"),this.prop.$navMap.setAttribute("onselect","document.selection.empty()");var r=document.createElement("canvas");r.className="map",r.width=t,r.height=o,this.prop.$navMap.appendChild(r),(window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("Edge")>-1)&&(r=window.G_vmlCanvasManager.initElement(r));var a=document.createElement("div");a.className="viewbox",this.prop.$navMap.appendChild(a);var l=this;this.$refs.$workArea.parentNode.addEventListener("scroll",(function(e){l._locateViewBox(parseFloat(l.prop.$navMap.getAttribute("scale")))})),this.prop.$navMap.querySelector(".viewbox").addEventListener("mousedown",(function(e){this.parentNode.setAttribute("isDown","1");var t=c["a"].mouseP(e),o=l.$refs.$workArea.parentNode,r=t.x,a=t.y,i={left:o.scrollLeft,top:o.scrollTop},n=parseFloat(this.parentNode.getAttribute("scale"));document.onmousemove=function(e){if("1"===l.prop.$navMap.getAttribute("isDown")){e||(e=window.event);var t=c["a"].mouseP(e);if(r===t.x&&a===t.y)return!1;o.scrollLeft=i.left+(t.x-r)/n,o.scrollTop=i.top+(t.y-a)/n}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,l.prop.$navMap.removeAttribute("isDown")}}))}else delete this.prop.$navMap}}},v=o("4676"),b=o("02d1"),m=o("0c15"),w=o("f871"),y=o("a10d"),x=o("e725"),C=o("bc3a"),_=o.n(C),$=o("abf2"),M={name:"DemoNavmap",components:{GooFlow:p["a"]},data:function(){return{myProps:{id:"aaaabbb",width:"800",height:"500",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["huber","router","plug2","complex mix"],nodeCustoms:{huber:{class:"custom_huber",width:102,height:50},router:{class:"custom_router",width:115,height:52}},auth:$["a"]},global:v["a"],plugIns:[b["a"],m["a"],w["a"],y["a"],x["a"],g]}},methods:{exportDiagram:function(){this.$refs.gooFlow.exportDiagram("myFlow")}},mounted:function(){var e=this.$refs.gooFlow;_.a.get("./demo/child.json",{},{headers:{"Content-Type":"application/json"}}).then((function(t){e.loadData(t.data)})),e.bindOperEvent({onPrintClick:function(){e.print()},onBtnSaveClick:function(){e.exportDiagram("myFlow")}})}},A=o("6b0d"),T=o.n(A);const S=T()(M,[["render",h]]);t["default"]=S}}]);