(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DemoMulti"],{"7a26":function(t,e,o){"use strict";o.r(e);var i=o("f2bf"),r={id:"DemoMulti"},l=Object(i["h"])("div",{style:{"margin-left":"auto","margin-right":"15px"}},"多选实验",-1);function s(t,e,o,s,p,n){var h=Object(i["A"])("goo-flow");return Object(i["t"])(),Object(i["g"])("div",r,[Object(i["k"])(h,{property:p.myProps,global:p.global,plugIns:p.plugIns,ref:"gooFlow"},{headerCustom:Object(i["H"])((function(){return[l]})),_:1},8,["property","global","plugIns"])])}var p=o("1fde"),n=o("4676"),h=o("02d1"),a=o("0c15"),u=o("f871"),f=o("a10d"),d=o("53ca"),c=(o("b64b"),o("14d9"),o("e9c4"),o("d4d2")),m=o("e7cb");Object.keys=Object.keys||function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(o);return e};var $={flag:"multi",prop:{$multiNodes:{},$multiLines:{},$multiKey:"shift"},events:{onBatchAdd:null,onBatchDel:null,onBatchMove:null,onBatchMark:null},methods:{_isMultiKey:function(t){return!(!t.shiftKey||"shift"!==this.prop.$multiKey)||!(!t.ctrlKey||"ctrl"!==this.prop.$multiKey)},_wallAllMulti:function(){if(this.prop.$multiNodes&&this.prop.$multiLines){if(0===Object.keys(this.prop.$multiNodes).length&&0===Object.keys(this.prop.$multiLines).length)return this.$refs.$multiGhost.hide(),void this.$refs.$multiOper.hide();var t=0,e=0,o=-1,i=-1;for(var r in this.prop.$multiNodes){var l=this.prop.$nodes[r];(-1===o||l.left<o)&&(o=l.left),(-1===i||l.top<i)&&(i=l.top),l.width+l.left>t&&(t=l.width+l.left),l.height+l.top>e&&(e=l.height+l.top)}for(var s in this.prop.$multiLines){var p=this.prop.$lines[s],n=document.getElementById(s),h=n.getAttribute("from").split(","),a=[];a[0]=parseFloat(h[0]),a[1]=parseFloat(h[1]);var u=n.getAttribute("to").split(","),f=[];f[0]=parseFloat(u[0]),f[1]=parseFloat(u[1]),"sl"===p.type||("tb"===p.type?(a[1]=p.M,f[1]=p.M):"lr"===p.type&&(a[0]=p.M,f[0]=p.M)),(-1===o||a[0]<o)&&(o=a[0]),(-1===o||f[0]<o)&&(o=f[0]),(-1===i||a[1]<i)&&(i=a[1]),(-1===i||f[1]<i)&&(i=f[1]),a[0]>t&&(t=a[0]),f[0]>t&&(t=f[0]),a[1]>e&&(e=a[1]),f[1]>e&&(e=f[1])}this.$refs.$multiGhost.show({left:o-2+"px",top:i-2+"px",width:t-o+4+"px",height:e-i+4+"px"}),this.$refs.$multiOper.show({left:t+4+"px",top:i-2+"px"})}},_addtoMultiList:function(t,e,o){var i=null;"node"===e?(this.prop.$multiNodes[t]=t,i=document.getElementById(t),c["a"].addClass(i,"item_focus"),i.style.borderColor=this.GooFlow.color.line):"line"===e&&(this.prop.$multiLines[t]=t,i=document.getElementById(t).querySelector("path[stroke-linecap='round']"),i.setAttribute("stroke","#ff8800"),this.prop.$lines[t].noArrow||i.setAttribute("marker-end","url(#arrow2)")),o&&this._wallAllMulti()},_removeFromMultiList:function(t,e,o){var i=null,r=null;if("node"===e){delete this.prop.$multiNodes[t],i=document.getElementById(t),c["a"].removeClass(i,"item_focus"),r=this.prop.$nodes[t];var l=this.prop.$nodeTypeMap[r.type]||r.type;r.marked?(c["a"].addClass(i,"item_mark"),i.style.borderColor=this.GooFlow.color.mark):l.indexOf(" mix")>0?i.style.borderColor=this.GooFlow.color.mix:this.prop.$nodeCustoms[l]?i.style.borderColor="transparent":i.style.borderColor=this.prop.$nodes[t].color||this.GooFlow.color.node}else"line"===e&&(delete this.prop.$multiLines[t],r=this.prop.$lines[t],i=document.getElementById(t).querySelector("path[stroke-linecap='round']"),r.marked||(i.setAttribute("stroke",r.color||this.GooFlow.color.line),r.noArrow||i.setAttribute("marker-end","url(#arrow1)")));o&&this._wallAllMulti()},_clearMultiList:function(){for(var t in this.prop.$multiNodes)this._removeFromMultiList(t,"node");for(var e in this.prop.$multiLines)this._removeFromMultiList(e,"line");this._wallAllMulti()},_initMultiSelect:function(t){var e=this;e.prop.$multiKey=t,this.$refs.$workArea.addEventListener("mousedown",(function(t){var o={X:0,Y:0};if("cursor"===e.prop.$nowType){if(e._isMultiKey(t))return!1;if(e.$refs.$multiGhost.inShow()){if(0===Object.keys(e.prop.$multiLines).length&&0===Object.keys(e.prop.$multiNodes).length)return void e._wallAllMulti();var i=e.$refs.$multiGhost.position(),r=e.$refs.$multiGhost.offsetSize();if(o=m["a"].getCoor(t,this),!(o.X<i.left||o.X>i.left+r.width||o.Y<i.top||o.Y>i.top+r.height))return r.left=i.left,r.top=i.top,void e._bindMoveEvent(t,r,(function(t,e,o,i,l){t&&e.batchMove(e.prop.$multiNodes,e.prop.$multiLines,i-r.left,l-r.top),e._wallAllMulti()}));var l=t.target,s=l.tagName;if(!("svg"===s||"DIV"===s&&l.className.indexOf("GooFlow_work")>-1||"LABEL"===s))return;e.$refs.$multiGhost.show({left:o.X+"px",top:o.Y+"px",width:"0px",height:"0px"}),e.$refs.$multiOper.hide()}else{var p=t.target,n=p.tagName;if(!("svg"===n||"DIV"===n&&p.className.indexOf("GooFlow_work")>-1||"LABEL"===n))return;o=m["a"].getCoor(t,this),e.$refs.$multiGhost.show({left:o.X+"px",top:o.Y+"px",width:"0",height:"0"}),e.$refs.$multiOper.hide()}var h=!1;document.onmousemove=function(t){t||(t=window.event);var i=m["a"].getCoor(t,e.$refs.$workArea),r=i.X-o.X,l=i.Y-o.Y,s=e.$refs.$multiGhost.position();r<0&&(s.left=o.X+r,r*=-1),l<0&&(s.top=o.Y+l,l*=-1),h=!0,e.$refs.$multiGhost.css({left:s.left+"px",top:s.top+"px",width:r+"px",height:l+"px"})},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null;var o=e.$refs.$multiGhost.position(),i=e.$refs.$multiGhost.offsetSize(),r={left:o.left,top:o.top,width:i.width,height:i.height};""!==e.prop.$focus&&e.blurItem(!1),e._clearMultiList(),h&&(e.$nextTick((function(){for(var t in e.prop.$nodes){var o=e.prop.$nodes[t],i={left:o.left*e.scale,top:o.top*e.scale,right:(o.left+o.width)*e.scale,bottom:(o.top+o.height)*e.scale},l=i.left>=r.left&&i.left<=r.left+r.width||i.right>=r.left&&i.right<=r.left+r.width,s=i.top>=r.top&&i.top<=r.top+r.height||i.bottom>=r.top&&i.bottom<=r.top+r.height;if(!l||!s){var p=i.left<=r.left&&i.right>=r.left+r.width&&(r.top<=i.top&&r.top+r.height>=i.top||r.top<=i.bottom&&r.top+r.height>=i.bottom),n=i.top<=r.top&&i.bottom>=r.top+r.height&&(r.left<=i.left&&r.left+r.width>=i.left||r.left<=i.right&&r.left+r.width>=i.right);if(!p&&!n)continue}e._addtoMultiList(t,"node")}for(var h in e.prop.$lines){var a=e.prop.$lines[h],u=void 0,f=void 0,d=void 0,c=document.getElementById(h),m=c.getAttribute("from").split(","),$=[];$[0]=parseFloat(m[0]),$[1]=parseFloat(m[1]);var v=c.getAttribute("to").split(","),g=[];g[0]=parseFloat(v[0]),g[1]=parseFloat(v[1]),"sl"===a.type||("tb"===a.type?($[1]=a.M,g[1]=a.M):"lr"===a.type&&($[0]=a.M,g[0]=a.M)),u=$[0]>=r.left&&$[0]<=r.left+r.width&&$[1]>=r.top&&$[1]<=r.top+r.height,f=g[0]>=r.left&&g[0]<=r.left+r.width&&g[1]>=r.top&&g[1]<=r.top+r.height,(u||f||("tb"===a.type?d=r.top<=g[1]&&g[1]<=r.top+r.height&&($[0]<=r.left&&g[0]>=r.left+r.width||g[0]<=r.left&&$[0]>=r.left+r.width):"lr"===a.type&&(d=r.left<=g[0]&&g[0]<=r.left+r.width&&($[1]<=r.top&&g[1]>=r.top+r.height||g[1]<=r.top&&$[1]>=r.top+r.height)),d))&&e._addtoMultiList(h,"line")}e._wallAllMulti()})),m["a"].stopEventPop(t))}}}))},batchMarkItem:function(t,e,o){if("function"!==typeof this.onBatchMark||!1!==this.onBatchMark(t,e,o)){if("object"===Object(d["a"])(t)&&"number"===typeof t.length&&t.length>0)for(var i=0;i<t.length;++i)this.markItem(t[i],o,!1,!0,!0);if("object"===Object(d["a"])(e)&&"number"===typeof e.length&&e.length>0)for(var r=0;r<e.length;++r)this.markItem(e[r],o,!1,!0,!0);"function"===typeof this.pushOper&&this.pushOper("batchMarkItem",[t,e,o]),this.prop["$navMap"]&&this.$nextTick((function(){this.refreshMap()}))}},batchAddItem:function(t,e){if("function"!==typeof this.onBatchAdd||!1!==this.onBatchAdd(t,e)){var o=[],i=[];for(var r in t)this.addNode(r,t[r],!1,!0,!0),i.push(r);for(var l in e)this.addLine(l,e[l],!1,!0,!0),o.push(l);"function"===typeof this.pushOper&&this.prop.$editable&&this.pushOper("batchDelete",[i,o]),this.prop["$navMap"]&&this.$nextTick((function(){this.refreshMap()}))}},batchDelete:function(t,e){if("function"!==typeof this.onBatchDel||!1!==this.onBatchDel(t,e)){var o={},i={};if("object"===Object(d["a"])(t)&&"number"===typeof t.length&&t.length>0)for(var r=0;r<t.length;++r)if(this.prop.$nodes[t[r]]&&null!=this.prop.$nodes[t[r]]){for(var l in i[t[r]]=JSON.parse(JSON.stringify(this.prop.$nodes[t[r]])),this.prop.$lines)this.prop.$lines[l].from!==t[r]&&this.prop.$lines[l].to!==t[r]||(o[l]=JSON.parse(JSON.stringify(this.prop.$lines[l])),this.delLine(l,!1,!0,!0),this.prop.$multiLines&&delete this.prop.$multiLines[l]);this.delNode(t[r],!1,!0,!0),this.prop.$multiNodes&&delete this.prop.$multiNodes[t[r]]}if("object"===Object(d["a"])(e)&&"number"===typeof e.length&&e.length>0)for(var s=0;s<e.length;++s)this.prop.$lines[e[s]]&&null!=this.prop.$lines[e[s]]&&(o[e[s]]=JSON.parse(JSON.stringify(this.prop.$lines[e[s]])),this.delLine(e[s],!1,!0,!0),this.prop.$multiLines&&delete this.prop.$multiLines[e[s]]);"function"===typeof this.pushOper&&this.prop.$editable&&this.pushOper("batchAddItem",[i,o]),this.prop["$navMap"]&&this.$nextTick((function(){this.refreshMap()}))}},batchMove:function(t,e,o,i){if((0!==Object.keys(t).length||0!==Object.keys(e).length)&&"number"===typeof o&&"number"===typeof i&&("function"!==typeof this.onBatchMove||!1!==this.onBatchMove(t,e,o,i))){var r={},l={};if("object"===Object(d["a"])(t))for(var s in t){var p=this.prop.$nodes[s];p&&null!=p&&(this.moveNode(s,p.left+o,p.top+i,!1,!0,!0),r[s]=s)}if("object"===Object(d["a"])(e))for(var n in e){var h=this.prop.$lines[n];if(h&&null!=h&&("lr"===h.type||"tb"===h.type)){h.Ml="lr"===h.type?i+h.Ml:o+h.Ml,h.Mr="lr"===h.type?i+h.Mr:o+h.Mr;var a="lr"===h.type?o+h.M:i+h.M;h.M=-1,this.setLineM(n,a,!0,!1,!0),l[n]=n}}"function"===typeof this.pushOper&&this.prop.$editable&&this.pushOper("batchMove",[r,l,-1*o,-1*i]),this.prop["$navMap"]&&this.$nextTick((function(){this.refreshMap()}))}}}},v=o("bc3a"),g=o.n(v),b=o("abf2"),y={name:"DemoMulti",components:{GooFlow:p["a"]},data:function(){return{myProps:{id:"multi_demo",width:"900",height:"600",haveHead:!0,headLabel:!0,headBtns:["new","open","save","undo","redo","reload","print"],haveTool:!0,useOperStack:!0,haveMulti:!0,haveDirDashed:!0,haveSegment:!0,haveSegDashed:!0,toolBtns:["start round mix","end round","task","node","chat","state","plug","join","fork","complex mix"],toolTextWidth:60,multiKey:"ctrl",auth:b["a"]},global:n["a"],plugIns:[h["a"],a["a"],u["a"],f["a"],$]}},mounted:function(){var t=this.$refs.gooFlow;g.a.get("./demo/data2.json",{},{headers:{"Content-Type":"application/json"}}).then((function(e){t.loadData(e.data)})),t.bindOperEvent({onPrintClick:function(){t.print()}})}},w=o("6b0d"),M=o.n(w);const O=M()(y,[["render",s]]);e["default"]=O}}]);